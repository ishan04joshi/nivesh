import{m as I,S as n,B as z,u as G,d as J,e as Q,r as u,f as K,a as X,j as o,b as r,H as m,c as h,M as Z,C as $,D as ee,F as te,G as se,J as re,K as ie,T as w,I as T,N as oe,g as ae,E as ne,i as le,n as ce,o as b,t as de,O as ue,P as he,Q as pe,U as ge,V as me,W as we,X as be}from"./index.9689f1a6.js";import{S as Ce}from"./index.esm.f6ed9a34.js";const Se=I(n),ye=I(z),xe={hidden:{scale:0},animate:{scale:1,transition:{staggerChildren:.5,delayChildren:.4}}},fe={hidden:{opacity:0},animate:{opacity:1}},We=()=>{var N,k;const a=G(),c=J();Q();const[C,B]=u.exports.useState(1),[S,F]=u.exports.useState(10),{isOpen:P,onOpen:W,onClose:y}=K(),{user:l}=X(),[d,R]=u.exports.useState([]),[x,E]=u.exports.useState(null),[f,L]=u.exports.useState(0),[g,v]=u.exports.useState(!1),[A,U]=u.exports.useState(""),p=async()=>{var e,i;try{const{data:t}=await pe(C,S);return t.error?a({title:"Error",description:t.message,status:"error",duration:3e3,isClosable:!0,position:"top-right"}):(R(t==null?void 0:t.data),a({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(t){console.error(t),a({title:"Error",description:((i=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:i.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},_=async e=>{var i,t;try{const{data:s}=await ge({id:e});return s.error?a({title:"Error",description:s.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"}):(p(),a({title:"Success",description:s.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(s){console.error(s),a({title:"Error",description:((t=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:t.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},V=async e=>{var i,t;try{if(!A)return a({title:"Error",description:"Please enter UTR",status:"error",duration:3e3,isClosable:!0});const{data:s}=await me({id:e,utr:A});if(s.error)return a({title:"Error",description:s.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});p(),a({title:"Success",description:s.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(s){console.error(s),a({title:"Error",description:((t=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:t.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},q=async e=>{var i,t;try{const{data:s}=await we({id:e});if(s.error)return a({title:"Error",description:s.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});p(),a({title:"Success",description:s.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(s){console.error(s),a({title:"Error",description:((t=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:t.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},H=async()=>{var e,i;if(!x||isNaN(f)||f<=0)return a({title:"Error",description:"Invalid details entered!",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"});v(!0);try{const{data:t}=await be({fund:x,amount:f});if(v(!1),t.error)return a({title:"Error",description:t.message,status:"error",duration:3e3,isClosable:!0,position:"top-right"});p(),y(),O(),a({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"})}catch(t){v(!1),console.error(t),a({title:"Error",description:((i=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:i.message)||"Something went wrong",status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},O=()=>{setNewsTitle(""),setNewsDescription(""),setNewsImage(null),setNewsCategory("")};return u.exports.useEffect(()=>{p()},[C,S]),u.exports.useEffect(()=>{var e,i;!((e=c==null?void 0:c.state)!=null&&e.fund)||(E((i=c==null?void 0:c.state)==null?void 0:i.fund),W())},[(N=c==null?void 0:c.state)==null?void 0:N.fund]),o(z,{sx:{minHeight:"90vh",display:"flex",flexDirection:"column",pb:4,px:2,py:4},children:[o(n,{direction:"row",justifyContent:"space-between",children:[r(m,{color:"gray.600",children:"Add Withdrawal"}),!(l!=null&&l.isAdmin)&&r(h,{colorScheme:"blue",onClick:W,children:"Request New Statement"})]}),o(Z,{onClose:y,isOpen:P,isCentered:!0,scrollBehavior:"inside",size:$({base:"sm",sm:"md",md:"md",lg:"lg",xl:"xl"}),sx:{mx:2},children:[r(ee,{}),o(te,{children:[r(se,{children:"Withdrawal Request"}),r(re,{}),r(ie,{children:o(n,{spacing:{base:6,md:10},children:[o(n,{spacing:1,children:[r(w,{color:"gray.700",children:"Available Funds:"}),r(Ce,{value:x,onChange:e=>E(e.target.value),placeholder:"Select a Fund",children:(k=l==null?void 0:l.funds)==null?void 0:k.map(e=>{var i,t,s;return r("option",{value:(i=e==null?void 0:e.id)==null?void 0:i._id,children:(t=e==null?void 0:e.id)==null?void 0:t.name},(s=e==null?void 0:e.id)==null?void 0:s._id)})})]}),o(n,{spacing:1,children:[r(w,{color:"gray.700",children:"Amount to Withdraw:"}),r(T,{placeholder:"Enter Amount",required:!0,type:"number",min:0,size:"md",onChange:e=>L(+e.target.value)})]}),o(n,{direction:"row",spacing:2,children:[r(h,{variant:"solid",bg:"#0D74FF",color:"white",onClick:H,isDisabled:g,isLoading:g,children:"Withdraw"}),r(h,{onClick:y,isDisabled:g,isLoading:g,children:"Close"})]}),r(n,{spacing:1,children:r(w,{color:"gray.700",fontSize:"0.7rem",children:"(Charges may applicable). (After approval of withdrawal request, it will take up to 3-4 working days to credit the amount in your Bank account)."})})]})}),r(oe,{})]})]}),o(Se,{variants:xe,initial:"hidden",animate:"animate",direction:"column",spacing:2,sx:{px:{sm:2,lg:6},pt:4},children:[(d==null?void 0:d.length)===0&&o(n,{direction:"column",spacing:3,justifyContent:"center",alignItems:"center",h:"80vh",children:[r(ae,{animationData:ne,autoPlay:!0,loop:!0,style:{height:"60vh",width:"60vw"}}),r(m,{children:"No Withdrawals Found!"})]}),r(n,{spacing:3,children:d==null?void 0:d.map((e,i)=>{var t,s,M,j,D;return r(ye,{variants:fe,px:8,py:4,rounded:"lg",shadow:"lg",bg:le("white","gray.800"),maxW:"100%",children:r(n,{direction:"row",spacing:2,justifyContent:"space-evenly",children:o(n,{ml:2,w:"100%",direction:"row",spacing:4,alignItems:"center",justifyContent:"space-between",children:[o(n,{direction:"row",spacing:2,divider:r(ce,{}),children:[o(n,{spacing:1,children:[o(m,{size:"xs",color:"gray.700",children:["User: ",(t=e==null?void 0:e.user)==null?void 0:t.firstName," ",(s=e==null?void 0:e.user)==null?void 0:s.lastName]}),o(w,{size:"xs",color:"gray.700",children:["PAN: ",(j=(M=e==null?void 0:e.user)==null?void 0:M.pan)==null?void 0:j.id]})]}),r(m,{size:"md",alignSelf:"center",children:(D=e==null?void 0:e.fund)==null?void 0:D.name}),r(b,{size:"lg",colorScheme:"blue",children:de(e==null?void 0:e.amount)}),r(b,{size:"lg",colorScheme:"blue",children:ue(e==null?void 0:e.createdAt).format("DD-MM-YYYY")}),r(b,{size:"lg",colorScheme:"green",children:e==null?void 0:e.status}),e.status==="completed"&&o(b,{size:"lg",colorScheme:"gray",children:["UTR: ",e==null?void 0:e.utr]})]}),o(n,{direction:"row",spacing:1,children:[(e==null?void 0:e.status)==="approved"&&(l==null?void 0:l.isAdmin)&&o(n,{spacing:1,direction:"row",children:[r(T,{onChange:Y=>U(Y.target.value),placeholder:"Enter UTR",w:"150px",alignSelf:"center",size:"xs"}),r(h,{alignSelf:"center",onClick:()=>V(e==null?void 0:e._id),colorScheme:"red",size:"sm",variant:"solid",children:"Complete"})]}),(e==null?void 0:e.status)==="pending"&&(l==null?void 0:l.isAdmin)&&o(n,{direction:"row",spacing:1,children:[(l==null?void 0:l.isAdmin)&&r(h,{onClick:()=>q(e==null?void 0:e._id),colorScheme:"red",size:"sm",variant:"solid",children:"Reject"}),r(h,{onClick:()=>_(e==null?void 0:e._id),colorScheme:"green",size:"sm",variant:"solid",children:"Approve"})]})]})]})})},i+e._id)})})]}),r(z,{sx:{},children:(d==null?void 0:d.length)>0&&r(he,{defaultPageSize:S,defaultPage:C,total:500,paginationProps:{display:"flex",justifyContent:"center",marginTop:"2em"},pageNeighbours:1,showQuickJumper:!0,responsive:!0,onChange:e=>B(e),onShowSizeChange:(e,i)=>F(parseInt(i)),showSizeChanger:!0})})]})};export{We as default};
