import{m as Q,S as c,B as z,b as ae,g as ne,u as ce,r as i,h as le,az as H,d as r,L as me,j as o,H as h,I as he,i as R,E as W,aJ as pe,T as u,l as S,p as b,o as _,t as C,e as x,aa as O,Q as w,P as ge,ar as de,as as Se,at as ue,au as B,av as I,aw as be,ax as P,ca as xe,cb as ye,cc as Ce,cd as ze,ce as ve,cf as we}from"./index.996e1d78.js";import{S as Me}from"./ScrollModal.27469081.js";const U=Q(c),G=Q(z),V={hidden:{scale:0},animate:{scale:1,transition:{staggerChildren:.5,delayChildren:.4}}},J={hidden:{opacity:0},animate:{opacity:1}},Pe=()=>{var A,j;const{user:d}=ae();ne();const l=ce(),[M,q]=i.exports.useState(1),[E,F]=i.exports.useState(10),[Ee,K]=i.exports.useState([]);i.exports.useState(null),i.exports.useState(null),i.exports.useState(!1),i.exports.useState(!1),le(),i.exports.useState("update"),i.exports.useState("HIGH"),i.exports.useState([]),i.exports.useState("SHORT");const[X,g]=i.exports.useState(!1),[Te,Y]=i.exports.useState(!1);H.useRef(null),H.useRef(null),i.exports.useState(null),i.exports.useState(null),i.exports.useState(""),i.exports.useState(""),i.exports.useState(""),i.exports.useState(0);const[T,Z]=i.exports.useState([]),[$,D]=i.exports.useState(!1),[k,L]=i.exports.useState(null),[v,f]=i.exports.useState(""),[ee,te]=i.exports.useState(0),y=async()=>{var e,a,n;try{g(!0);const{data:t}=await xe(M,E);g(!1),Y(!0);const{data:p}=await ye();return(t==null?void 0:t.error)||(p==null?void 0:p.error)?l({title:"Error",description:(t==null?void 0:t.message)||(p==null?void 0:p.message),status:"error",duration:9e3,isClosable:!0}):(K((e=p==null?void 0:p.data)==null?void 0:e.funds),Z((t==null?void 0:t.data)||[]),te((t==null?void 0:t.count)||0),l({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(t){Y(!0),g(!1),console.log(t),l({title:"Error",description:(n=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:n.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-right"})}},re=async e=>{var a,n;try{g(!0);const{data:t}=await Ce(e);return g(!1),t.error?l({title:"Error",description:t.message,status:"error",duration:9e3,isClosable:!0}):(y(),l({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(t){console.error(t),l({title:"Error",description:((n=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:n.message)||"Internal Server Error!",status:"error",duration:3e3,isClosable:!0,position:"top-right"})}},se=async e=>{var a,n;try{g(!0);const{data:t}=await ze(e);return g(!1),t.error?l({title:"Error",description:t.message,status:"error",duration:9e3,isClosable:!0}):(y(),l({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(t){console.error(t),l({title:"Error",description:((n=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:n.message)||"Internal Server Error!",status:"error",duration:3e3,isClosable:!0,position:"top-right"})}},oe=async e=>{var a,n;try{g(!0);const{data:t}=await ve(e);return g(!1),t.error?l({title:"Error",description:t.message,status:"error",duration:9e3,isClosable:!0}):(y(),l({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(t){console.error(t),l({title:"Error",description:((n=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:n.message)||"Internal Server Error!",status:"error",duration:3e3,isClosable:!0,position:"top-right"})}},ie=async e=>{var a,n;try{g(!0);const{data:t}=await we(e);return g(!1),t.error?l({title:"Error",description:t.message,status:"error",duration:9e3,isClosable:!0}):(y(),l({title:"Success",description:t.message,status:"success",duration:3e3,isClosable:!0,position:"bottom-right"}))}catch(t){console.error(t),l({title:"Error",description:((n=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:n.message)||"Internal Server Error!",status:"error",duration:3e3,isClosable:!0,position:"top-right"})}},m=i.exports.useMemo(()=>d.isAdmin?T.filter(e=>{var a,n;return v?((a=e==null?void 0:e.user)==null?void 0:a.firstName.toLowerCase().includes(v.toLowerCase()))||((n=e==null?void 0:e.user)==null?void 0:n.lastName.toLowerCase().includes(v.toLowerCase())):!0}):T,[v,T]);return i.exports.useEffect(()=>{y()},[M,E]),X?r(z,{children:r(me,{})}):o(z,{sx:{minHeight:"90vh",display:"flex",flexDirection:"column",pb:4},children:[o(c,{direction:"row",justifyContent:"space-between",children:[r(h,{color:"gray.600",children:"Subscriptions"}),(d==null?void 0:d.isAdmin)&&r(he,{w:"200px",placeholder:"Search By Name..",onChange:e=>f(e.target.value),focusBorderColor:"blue.500",variant:"filled",bg:"white"})]}),(d==null?void 0:d.isAdmin)&&o(U,{variants:V,initial:"hidden",animate:"animate",direction:"column",spacing:2,sx:{px:{sm:2,lg:6},pt:4},children:[(m==null?void 0:m.length)===0&&o(c,{direction:"column",spacing:3,justifyContent:"center",alignItems:"center",h:"80vh",children:[r(R,{animationData:W,autoPlay:!0,loop:!0,style:{height:"60vh",width:"60vw"}}),r(h,{children:"No Subscriptions Found"})]}),(m==null?void 0:m.length)>0&&r(pe,{children:m==null?void 0:m.map(e=>{var a,n,t,p;return o(z,{border:"1px",rounded:"lg",p:4,borderColor:"gray.300",children:[o(c,{direction:"row",spacing:2,py:4,children:[o(u,{fontSize:"sm",color:"gray.600",fontWeight:"bold",children:["Name: ",(a=e==null?void 0:e.user)==null?void 0:a.firstName," ",(n=e==null?void 0:e.user)==null?void 0:n.lastName]}),o(u,{fontSize:"sm",color:"gray.600",fontWeight:"bold",children:["Mobile: ",(t=e==null?void 0:e.user)==null?void 0:t.phone]})]}),(p=e==null?void 0:e.subscriptions)==null?void 0:p.map((s,De)=>{var N;return o(G,{variants:J,px:8,py:4,rounded:"lg",shadow:"lg",bg:S("white","gray.800"),maxW:"100%",children:[r(b,{size:"md",variant:"solid",px:3,bg:s.trending?"green.900":"red.900",color:"gray.100",fontSize:"sm",fontWeight:"700",rounded:"md",children:s.status}),o(c,{direction:"row",spacing:2,mt:2,divider:r(_,{}),justifyContent:"space-evenly",children:[o(c,{direction:"column",spacing:1,children:[r(h,{fontSize:"md",children:"Paid Amount"}),r(h,{fontSize:"sm",children:C((s==null?void 0:s.paidCounts)*(s==null?void 0:s.amount))})]}),o(c,{direction:"column",spacing:1,children:[r(h,{fontSize:"md",children:"Remaining Amount"}),r(b,{size:"sm",colorScheme:"green",variant:"subtle",children:C((s==null?void 0:s.remainingCounts)*(s==null?void 0:s.amount))})]}),o(c,{direction:"column",spacing:1,children:[r(h,{fontSize:"md",children:"Transactions: "}),r(x,{size:"xs",onClick:()=>{L(s==null?void 0:s.transactions),D(!0)},children:"Show Details"})]}),o(c,{direction:"column",spacing:1,children:[o(h,{fontSize:"md",children:["FUND",r("br",{}),(N=s==null?void 0:s.fund)==null?void 0:N.name.substring(0,20)]}),r(b,{size:"sm",colorScheme:s.riskCategory==="HIGH"&&"red"||s.riskCategory==="MEDIUM"&&"yellow"||s.riskCategory==="LOW"&&"green",children:s==null?void 0:s.riskCategory})]})]}),o(O,{justifyContent:"space-around",alignItems:"center",mt:4,children:[o(u,{fontSize:"sm",noOfLines:0,color:S("gray.600","gray.400"),children:["Created:"," ",w(s==null?void 0:s.createdAt).format("dddd, DD MMMM YYYY")]}),o(u,{fontSize:"sm",noOfLines:0,color:S("gray.600","gray.400"),children:["End Date:"," ",w(s==null?void 0:s.endDate).format("dddd, DD MMMM YYYY")]})]})]},s==null?void 0:s._id)})]},e==null?void 0:e._id)})})]}),!(d!=null&&d.isAdmin)&&o(U,{variants:V,initial:"hidden",animate:"animate",direction:"column",spacing:2,sx:{px:{sm:2,lg:6},pt:4},children:[((A=m==null?void 0:m.subscriptions)==null?void 0:A.length)===0&&o(c,{direction:"column",spacing:3,justifyContent:"center",alignItems:"center",h:"80vh",children:[r(R,{animationData:W,autoPlay:!0,loop:!0,style:{height:"60vh",width:"60vw"}}),r(h,{children:"No Subscriptions Found"})]}),(j=m==null?void 0:m.subscriptions)==null?void 0:j.map((e,a)=>{var n;return o(G,{variants:J,px:8,py:4,rounded:"lg",shadow:"lg",bg:S("white","gray.800"),maxW:"100%",children:[r(b,{size:"md",variant:"solid",variantColor:"green",px:3,bg:e.trending?"green.900":"red.900",color:"gray.100",fontSize:"sm",fontWeight:"700",rounded:"md",children:e.status}),o(c,{direction:"row",spacing:2,mt:2,divider:r(_,{}),justifyContent:"space-evenly",children:[o(c,{direction:"column",spacing:1,children:[r(h,{fontSize:"md",children:"Paid Amount"}),r(h,{fontSize:"sm",children:C((e==null?void 0:e.paidCounts)*(e==null?void 0:e.amount))}),o(h,{fontSize:"sm",children:["Paid Times: ",e==null?void 0:e.paidCounts]})]}),o(c,{direction:"column",spacing:1,children:[r(h,{fontSize:"md",children:"Remaining Amount"}),r(b,{size:"sm",colorScheme:"green",variant:"subtle",children:C((e==null?void 0:e.remainingCounts)*(e==null?void 0:e.amount))})]}),o(c,{direction:"column",spacing:1,children:[r(h,{fontSize:"md",children:"Transactions: "}),r(x,{size:"xs",onClick:()=>{L(e==null?void 0:e.transactions),D(!0)},children:"Show Details"})]}),o(c,{direction:"column",spacing:1,children:[o(h,{fontSize:"md",children:["FUND",r("br",{}),(n=e==null?void 0:e.fund)==null?void 0:n.name.substring(0,20)]}),r(b,{size:"sm",colorScheme:e.riskCategory==="HIGH"&&"red"||e.riskCategory==="MEDIUM"&&"yellow"||e.riskCategory==="LOW"&&"green",children:e==null?void 0:e.riskCategory})]})]}),o(O,{justifyContent:"space-around",alignItems:"center",mt:4,children:[o(u,{fontSize:"sm",noOfLines:0,color:S("gray.600","gray.400"),children:["Created: ",w(e==null?void 0:e.createdAt).format("dddd, DD MMMM YYYY")]}),o(u,{fontSize:"sm",noOfLines:0,color:S("gray.600","gray.400"),children:["End Date: ",w(e==null?void 0:e.endDate).format("dddd, DD MMMM YYYY")]}),o(c,{direction:"row",spacing:1,children:[r(x,{color:S("brand.600","brand.400"),_hover:{bg:"green.700"},size:"sm",variant:"outline",onClick:()=>re(e==null?void 0:e.subscription),children:"Pause"}),r(x,{color:S("brand.600","brand.400"),_hover:{bg:"green.700"},size:"sm",variant:"outline",onClick:()=>ie(e==null?void 0:e.subscription),children:"Cancel"}),r(x,{color:S("brand.600","brand.400"),_hover:{bg:"green.700"},size:"sm",variant:"outline",onClick:()=>se(e==null?void 0:e.subscription),children:"Resume"}),r(x,{color:S("brand.600","brand.400"),_hover:{bg:"green.700"},size:"sm",variant:"outline",onClick:()=>oe(e==null?void 0:e.subscription),children:"Sync"}),"handleSyncSubscription"]})]})]},e==null?void 0:e._id)})]}),r(z,{children:r(ge,{defaultPageSize:E,defaultPage:M,total:ee,paginationProps:{display:"flex",justifyContent:"center",marginTop:"2em"},pageNeighbours:1,showQuickJumper:!0,responsive:!0,onChange:e=>q(e),onShowSizeChange:(e,a)=>F(parseFloat(a)),showSizeChanger:!0})}),r(Me,{showDailyChange:$,setShowDailyChange:D,title:"Subscription Transactions",children:r(de,{children:o(Se,{size:"sm",children:[r(ue,{children:o(B,{children:[r(I,{children:"Status"}),r(I,{children:"Amount"}),r(I,{children:"Subscription"})]})}),r(be,{children:k==null?void 0:k.map(e=>o(B,{children:[r(P,{children:e==null?void 0:e.status}),r(P,{children:C(e==null?void 0:e.amountPaid)}),r(P,{children:e==null?void 0:e.subscription})]},e==null?void 0:e._id))})]})})})]})};export{Pe as default};
